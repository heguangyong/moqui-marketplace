<?xml version="1.0" encoding="UTF-8"?>
<entity-facade-xml type="seed-initial">

    <moqui.security.ArtifactGroup artifactGroupId="MARKETPLACE_APP" description="Marketplace App (via root screen)"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_XML_SCREEN"
            inheritAuthz="Y" artifactName="component://moqui-marketplace/screen/marketplace.xml"/>

    <!-- Marketplace Services Group -->
    <moqui.security.ArtifactGroup artifactGroupId="MARKETPLACE_SERVICES" description="Marketplace Services"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_SERVICES" artifactTypeEnumId="AT_SERVICE"
            inheritAuthz="Y" artifactName="marketplace.*"/>

    <!-- Add marketplace services to the main group -->
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_SERVICE"
            inheritAuthz="Y" artifactName="marketplace.get#MerchantStatistics"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_SERVICE"
            inheritAuthz="Y" artifactName="marketplace.process#AllMatching"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_SERVICE"
            inheritAuthz="Y" artifactName="marketplace.initialize#DemoData"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_SERVICE"
            inheritAuthz="Y" artifactName="marketplace.*"/>

    <!-- Marketplace Services Group Authorization -->
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_SVC_AUTHZ_ADMIN" userGroupId="ADMIN" artifactGroupId="MARKETPLACE_SERVICES"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_SVC_AUTHZ_ANONYMOUS" userGroupId="_NA_" artifactGroupId="MARKETPLACE_SERVICES"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_SVC_AUTHZ_ALL_USERS" userGroupId="ALL_USERS" artifactGroupId="MARKETPLACE_SERVICES"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Additional explicit permissions for these services -->
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_SERVICES_ALL" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_SERVICE" artifactName="marketplace.process#AllMatching"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_SERVICES_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_SERVICE" artifactName="marketplace.process#AllMatching"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_INIT_ALL" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_SERVICE" artifactName="marketplace.initialize#DemoData"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_INIT_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_SERVICE" artifactName="marketplace.initialize#DemoData"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Add mcp services to the group -->
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_SERVICE"
            inheritAuthz="Y" artifactName="moqui.mcp.get#SmartRecommendations"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_SERVICE"
            inheritAuthz="Y" artifactName="moqui.mcp.*"/>

    <!-- Add MCP dialog entities to the group -->
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="mcp.dialog.McpDialogSession"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="mcp.dialog.McpDialogMessage"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="mcp.*"/>

    <!-- Explicit MCP entity permissions for anonymous users -->
    <moqui.security.ArtifactAuthz artifactAuthzId="MCP_DIALOG_SESSION_AUTHZ_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_ENTITY" artifactName="mcp.dialog.McpDialogSession"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MCP_DIALOG_MESSAGE_AUTHZ_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_ENTITY" artifactName="mcp.dialog.McpDialogMessage"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Explicit MCP entity permissions for all users -->
    <moqui.security.ArtifactAuthz artifactAuthzId="MCP_DIALOG_SESSION_AUTHZ_ALL" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_ENTITY" artifactName="mcp.dialog.McpDialogSession"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MCP_DIALOG_MESSAGE_AUTHZ_ALL" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_ENTITY" artifactName="mcp.dialog.McpDialogMessage"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Marketplace Entities Group -->
    <moqui.security.ArtifactGroup artifactGroupId="MARKETPLACE_ENTITIES" description="Marketplace Entities"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_ENTITIES" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="marketplace.*"/>

    <!-- Marketplace Entities Group Authorization -->
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_ENT_AUTHZ_ADMIN" userGroupId="ADMIN" artifactGroupId="MARKETPLACE_ENTITIES"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_ENT_AUTHZ_ANONYMOUS" userGroupId="_NA_" artifactGroupId="MARKETPLACE_ENTITIES"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_ENT_AUTHZ_ALL_USERS" userGroupId="ALL_USERS" artifactGroupId="MARKETPLACE_ENTITIES"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Specific entity authorizations for anonymous users -->
    <moqui.security.ArtifactAuthz artifactAuthzId="SUPPLY_LISTING_AUTHZ_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_ENTITY" artifactName="marketplace.SupplyListing"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="DEMAND_LISTING_AUTHZ_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_ENTITY" artifactName="marketplace.DemandListing"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="LISTING_AUTHZ_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_ENTITY" artifactName="marketplace.listing.Listing"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MATCH_AUTHZ_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_ENTITY" artifactName="marketplace.match.Match"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Specific entity authorizations for all users -->
    <moqui.security.ArtifactAuthz artifactAuthzId="SUPPLY_LISTING_AUTHZ_ALL" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_ENTITY" artifactName="marketplace.SupplyListing"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="DEMAND_LISTING_AUTHZ_ALL" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_ENTITY" artifactName="marketplace.DemandListing"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="LISTING_AUTHZ_ALL" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_ENTITY" artifactName="marketplace.listing.Listing"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MATCH_AUTHZ_ALL" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_ENTITY" artifactName="marketplace.match.Match"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Add marketplace entities to the group -->
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="marketplace.listing.Listing"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="marketplace.*"/>

    <!-- Add marketplace view entities to the group -->
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="marketplace.SupplyListing"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="marketplace.DemandListing"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="marketplace.MatchResult"/>

    <!-- Add Moqui core entities that form-list components may need -->
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="moqui.screen.form.FormConfigUser"/>
    <moqui.security.ArtifactGroupMember artifactGroupId="MARKETPLACE_APP" artifactTypeEnumId="AT_ENTITY"
            inheritAuthz="Y" artifactName="moqui.screen.form.*"/>

    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_AUTHZ_ALL" userGroupId="ADMIN" artifactGroupId="MARKETPLACE_APP"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Ensure john.doe is in ADMIN group -->
    <moqui.security.UserGroupMember userGroupId="ADMIN" userId="EX_JOHN_DOE" fromDate="2024-01-01 00:00:00"/>
    <moqui.security.UserGroupMember userGroupId="ADMIN" userId="john.doe" fromDate="2024-01-01 00:00:00"/>

    <!-- Allow ALL users to access marketplace services (since screens have require-authentication="false") -->
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_AUTHZ_PUBLIC" userGroupId="ALL_USERS" artifactGroupId="MARKETPLACE_APP"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Explicit permission for anonymous users -->
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_AUTHZ_ANONYMOUS" userGroupId="_NA_" artifactGroupId="MARKETPLACE_APP"
            authzTypeEnumId="AUTHZT_ALWAYS" authzActionEnumId="AUTHZA_ALL"/>

    <!-- Add explicit entity permissions for anonymous users -->
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_ENTITY_AUTHZ_ANONYMOUS" userGroupId="_NA_" artifactGroupId="MARKETPLACE_APP"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_VIEW"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="MARKETPLACE_ENTITY_AUTHZ_PUBLIC" userGroupId="ALL_USERS" artifactGroupId="MARKETPLACE_APP"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_VIEW"/>

    <!-- Specific anonymous user permissions for FormConfigUser -->
    <moqui.security.ArtifactAuthz artifactAuthzId="FORMCONFIG_AUTHZ_ANONYMOUS" userGroupId="_NA_"
            artifactTypeEnumId="AT_ENTITY" artifactName="moqui.screen.form.FormConfigUser"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_VIEW"/>
    <moqui.security.ArtifactAuthz artifactAuthzId="FORMCONFIG_AUTHZ_PUBLIC" userGroupId="ALL_USERS"
            artifactTypeEnumId="AT_ENTITY" artifactName="moqui.screen.form.FormConfigUser"
            authzTypeEnumId="AUTHZT_ALLOW" authzActionEnumId="AUTHZA_VIEW"/>

</entity-facade-xml>